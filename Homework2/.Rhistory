library(knitr)
library(tidyverse)
library(ISLR)
library(ROCR)
library(dplyr)
library(ggplot2)
# set global chunk options: images will be 7x5 inches
knitr::opts_chunk$set(
fig.height = 5,
fig.width = 7,
warning = FALSE
)
options(digits = 4)
## indents are for indenting r code as formatted text
## They may need to be adjusted depending on your OS
# if your output looks odd, increase or decrease indent
indent1 = '    '
indent2 = '        '
indent3 = '            '
algae <- read.table("algaeBloom.txt", col.names=
c('season','size','speed','mxPH','mnO2','Cl','NO3','NH4',
'oPO4','PO4','Chla','a1','a2','a3','a4','a5','a6','a7'),
na = "XXXXXXX")
glimpse(algae)
glimpse(Auto)
glimpse(Auto)
lmod <- lm(Auto$mpg ~ ., )
glimpse(Auto)
lmod <- lm(mpg ~ ., data = Auto)
glimpse(Auto)
lmod <- lm(mpg ~ ., data = Auto)
lmod
glimpse(Auto)
Auto_clean <- Auto %>%
select(-contains("name"))
lmod <- lm(mpg ~ ., data = Auto_clean)
lmod
glimpse(Auto)
Auto_clean <- Auto %>%
select(-contains("name"))
lmod <- lm(mpg ~ ., data = Auto_clean)
summary(lmod)
mean((Auto$mpg - predict(lmod, Auto_clean))^2)
training_MSE <- mean((Auto$mpg - predict(lmod, Auto_clean))^2)
training_MSE
car <- data.frame(
cylinders = 4,
displacement = 133,
horsepower = 117,
weight = 3250,
acceleration = 29,
year = 97,
origin = 2
)
car <- data.frame(
cylinders = 4,
displacement = 133,
horsepower = 117,
weight = 3250,
acceleration = 29,
year = 97,
origin = 2
)
predict(lmod, newdata = car)
car <- data.frame(
cylinders = 4,
displacement = 133,
horsepower = 117,
weight = 3250,
acceleration = 29,
year = 97,
origin = 2
)
car_pre_mpg <- predict(lmod, newdata = car)
coef(lm.fit)
coef(lmod)
glimpse(Auto)
Auto_clean <- Auto %>%
select(-contains("name")) %>%
mutate(origin = as.factor(origin))
lmod <- lm(mpg ~ ., data = Auto_clean)
summary(lmod)
training_MSE <- mean((Auto$mpg - predict(lmod, Auto_clean))^2)
training_MSE <- mean((Auto$mpg - predict(lmod, Auto_clean))^2)
car <- data.frame(
cylinders = 4,
displacement = 133,
horsepower = 117,
weight = 3250,
acceleration = 29,
year = 97,
origin = 2
)
car_pre_mpg <- predict(lmod, newdata = car)
car <- data.frame(
cylinders = 4,
displacement = 133,
horsepower = 117,
weight = 3250,
acceleration = 29,
year = 97,
origin = factor(2)
)
car_pre_mpg <- predict(lmod, newdata = car)
coef(lmod)
coef(lmod)[1]
coef(lmod)[4]
coef(lmod)[4,1]
coef(lmod)[4][1]
coef(lmod)[4] * 30
algae <- read.table("algaeBloom.txt", col.names=
c('season','size','speed','mxPH','mnO2','Cl','NO3','NH4',
'oPO4','PO4','Chla','a1','a2','a3','a4','a5','a6','a7'),
na = "XXXXXXX")
glimpse(algae)
algae.transformed <- algae %>% mutate_at(vars(4:11), funs(log(.)))
algae.transformed <- algae.transformed %>%
mutate_at(vars(4:11),funs(ifelse(is.na(.),median(.,na.rm=TRUE),.)))
# a1 == 0 means low
algae.transformed <- algae.transformed %>% mutate(a1 = factor(as.integer(a1 > 5), levels = c(0, 1)))
calc_error_rate <- function(predicted.value, true.value) {
return(mean(true.value != predicted.value))
}
set.seed(1)
test.indices = sample(1:nrow(algae.transformed), 50)
algae.train=algae.transformed[-test.indices,]
algae.test=algae.transformed[test.indices,]
library(knitr)
library(tidyverse)
library(ISLR)
library(ROCR)
library(dplyr)
library(ggplot2)
library(MASS)
# set global chunk options: images will be 7x5 inches
knitr::opts_chunk$set(
fig.height = 5,
fig.width = 7,
warning = FALSE
)
options(digits = 4)
## indents are for indenting r code as formatted text
## They may need to be adjusted depending on your OS
# if your output looks odd, increase or decrease indent
indent1 = '    '
indent2 = '        '
indent3 = '            '
lda_mod <- lda(a1 ~ ., data = algae.test)
lda_mod <- lda(a1 ~ ., data = algae.test, CV = T)
